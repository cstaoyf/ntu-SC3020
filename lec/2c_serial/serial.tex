\documentclass{beamer}

\usetheme{Warsaw}
%\usetheme{CambridgeUS}

\input{./def/yf-beamer.tex}
\usepackage{color}
\usepackage{graphicx}
\usepackage{multirow}
\usepackage{wrapfig}
\usepackage[skins,breakable]{tcolorbox}

\def\done{\hfill$\square$}
\def\ttt{\texttt}
\def\vgap{\vspace{5mm}}

\def\abt{\ttt{ABORT}}
\def\best{\mit{best}}
\def\cmt{\ttt{COMMIT}}
\def\ins{\ttt{INSERT}}
\def\rd{\ttt{READ}}
\def\size{\mit{size}}
\def\sort{\mit{sort}}
\def\wt{\ttt{WRITE}}

\title[DATABASE SYSTEM PRINCIPLES]{Transactions 3:\\ Serializability}

\author[Yufei Tao @ NTU]{Yufei Tao}
\institute[]{\url{https://www.cse.cuhk.edu.hk/~taoyf}}
\date{}

% \def\dtm{\mathit{d\mbox{-}tm}}
% \def\ftm{\mathit{f\mbox{-}tm}}
\def\bestext{\mathit{best\mbox{-}ext}}

\begin{document}
%-------------------------------------------------------------
\begin{frame}
    \titlepage
%     \begin{tcolorbox}[arc=0mm, colframe=green!50!black, colback=green!10!white] 
%     \end{tcolorbox}
\end{frame}
%-------------------------------------------------------------
\begin{frame}
\begin{small}
    This lecture focuses on \bred{serializable schedules}. We will learn a conservative method to check whether a schedule is serializable.

    \vgap

    Recall:
    \cbox{blue}{
        A schedule is \blue{serializable} if it results in the same database state as \bred{some} serial schedule. Otherwise, it is \blue{non-serializable}.
    }
\end{small}    
\end{frame}
%-------------------------------------------------------------
\myfrm{
    \cbox{green}{
        \blue{Example:} The following schedule is serializable.
        \begin{center}
        \begin{tabular}{c|c|c}
            & $\red{T_1}$ & $\red{T_2}$\\
            \hline
            1&& \rd($\red{A}$) \\
            2&& $A = A + 1$ \\
            3&& \wt($A$) \\
            4&\rd($\red{A}$) & \\
            5&$B = A$ & \\
            6&\wt($B$) &\\
            7&& \cmt \\
            8&\cmt &
        \end{tabular}
        \end{center}

        It is equivalent to the serial schedule $(T_2, T_1)$, but \bred{not} equivalent to the serial schedule $(T_1, T_2)$.
    }
}
%-------------------------------------------------------------
\myfrm{
    \cbox{green}{
        \blue{Example:} The following schedule is non-serialzable.

        \begin{center}
        \begin{tabular}{c|c|c}
            &$\red{T_1}$ & $\red{T_2}$\\
            \hline
            1&\rd($\red{A}$) & \\
            2&$A = A + 1$ &\\
            3&& \rd($\red{A}$) \\
            4&& $A = A + 1$ \\
            5&\wt($A$) & \\
            6&& \wt($A$) \\
            7&& \cmt \\
            8&\cmt &
        \end{tabular}
        \end{center}

        \vgap

        If $A$ was 0 before running the schedule, what is its value afterwards?
    }
}
%-------------------------------------------------------------
\myfrm{
    \cbox{green}{
        \blue{Example:}
        \begin{center}
        \begin{tabular}{c|c|c}
            &$\red{T_1}$ & $\red{T_2}$\\
            \hline
            1&\rd($\red{A}$) & \\
            2&$A = A + 1$ &\\
            3&& \rd($\red{A}$) \\
            4&& $A = A + 1$ \\
            5&\wt($A$) & \\
            6&& \wt($A$) \\
            7&& \cmt \\
            8&\cmt &
        \end{tabular}
        \end{center}

        Instructions 1 and 6 are in conflict.
        Instructions 3 and 5 are in conflict.
        Instructions 5 and 6 are in conflict.
    }
}
%-------------------------------------------------------------
\myfrm{
    \cbox{blue}{
        Let $\red{I_1}$ and $\red{I_2}$ be instructions in a schedule that belong to different transactions. They are in \blue{conflict} if \bred{one} of the following is true:
        \myitems{
            \item $I_1 = \red{\rd(X)}$ and $I_2 = \red{\wt(X)}$ for some value $X$;
            \item $I_1 = \red{\wt(X)}$ and $I_2 = \red{\rd(X)}$ for some value $X$;
            \item $I_1 = \red{\wt(X)}$ and $I_2 = \red{\wt(X)}$ for some value $X$.
        }
    }
}
%-------------------------------------------------------------
\end{document} 



